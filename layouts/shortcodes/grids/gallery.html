{{ $layer := resources.Get "images/overlay.png" -}}
{{ $loading := .Get "loading" -}}

<div class="carousel">
  {{ range .Page.Resources.Match (.Get "pattern") }}
    {{ $img := .Resize "x400" }}
    {{ $x := sub $img.Width 80 }}
    {{ $img := $img | images.Filter ( images.Overlay $layer $x 300 ) }}
    <img
        loading="{{ with .Params.loading }}.{{ else }}{{ $loading | default "" }}{{ end }}"
        src="{{ $img.RelPermalink }}"
        alt="{{ $img.Title }}">
  {{ end }}
</div>
